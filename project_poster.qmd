---
title: Visualising Inflation in Singapore Across Various Industries
format: 
    poster-typst:
        size: "33x23"
        poster-authors: "Chua Joshua, Lim Joshua, Ong Zi Xuan Max, Ray Lim Le Hao, Sherwyn Tan Wee Wen, Tan Jia Wen"
        departments: "Information and Communication Technologies"
        institution-logo: "./images/sit-logo.png"
        footer-text: "Information Visualization 2024"
execute:
  echo: false
knitr:
  opts_chunk:
    dev: svglite
---

```{r}
#| label: setup
#| include: false

library(knitr)
library(ggplot2)
purl("project_prep.qmd")
source("project_prep.R")
```

# Introduction
The infographic published by The Straits Times provides a comprehensive overview of how prices have changed in 2023. Featuring a heat map, it visually represents the monthly inflationary impact on a wide range of key items. This illustration highlights the varying rates of price changes across different categories of goods and services (e.g. food, healthcare, transportation, etc.) throughout the year. Through this visual tool, readers can gain a deeper understanding of the broader economic landscape and discern inflation trends and their impacts on essential goods and services in Singapore. In addition, this information allows readers to assess whether their personal experiences with inflation align with the actual data collected, offering a clearer picture of the economic environment.

# Previous Visualization

```{r}
#| label: old-vis-on-poster
#| fig-cap: "Heat map of inflationary impact on key items over 2023."
#| out-width: 100%
#| out-height: 50%

include_graphics("images/old_poster.png")
```

# Strengths
-   The heatmap has organized the information in different categories which allow users to see the impact of inflation towards different domains over the months from 2022 to 2023.

-   Each category is clearly labelled while being separated with padding and a line to ensure users can focus on one category at a time without accidentally reading information from another category. This eases the visual load of the user which reduces the time needed for the users to understand the heatmap

-   The average column calculates the average change between the years which allows the users to see the overall impact of the inflation for the different domains.

-   Data source has been credited at the end of the heatmap where the source is from the Singapore Department of Statistics

# Suggested Improvements

1.  *Spelling out the months instead of just letters* could provide better understanding of the graph. Letters may result in the reader needing more time to interpret them in the poster which increases the cognitive load of the reader.

2.  *Include change in Inflation Rate from the past few years* which allow readers to compare the trend of the inflation rate changes over the past years with the changes from 2023. This portrays the message of the poster more clearly as it shows impact of inflation in 2023 compared to past years.

3.  *Implementing a line chart instead of the heat map* allows readers to see trends more clearly as they do not have to refer to the color legend to understand the graph.

4.  *Clarify or remove vague sections* such as:

    -   "Food (excludes food-serving services)" which require more clarification on what services are being excluded

    -   "Miscellaneous goods and services" is too generalize.


# Implementation

## Data

-   The change in inflation rate from the past few years since 1962 from different domains were obtained from the SingStat Website.[^1] The data does contain missing data however, after filtering and selecting the relevant years we need for our plot, we manage to remove the missing data from our table.

[^1]: https://www.singstat.gov.sg/-/media/files/publications/economy/cpiapr24.ashx

## Software

We used the Quarto publication framework and the R programming language, along with the following third-party packages:

-   *readxl* for data import
-   *tidyverse* for data transformation, including *ggplot2* for visualization based on the grammar of graphics
-   *knitr* for dynamic document generation
-   *zoo* for interpolating annual population data from the decennial U.S.Â census

# Overview Visualization - 1
```{r}
#| label: overview-visualization-1

# Define custom colors for the lines
line_colors <- c("2020" = "grey", "2021" = "grey", "2022" = "grey", "2023" = "blue")

# Generate the line plot with enhanced background blocks and additional improvements
ggplot(all_items_data, aes(x = Date, y = Value, group = 1)) +
  # Background blocks
  geom_rect(data = all_items_data, aes(xmin = Date, xmax = lead(Date, default = last(Date)), 
                                       ymin = -Inf, ymax = Inf), alpha = 0.1, fill = "lightgrey") +
  # Main line and points
  geom_line(aes(color = as.factor(Year)), size = 1.5) +
  # geom_point(size = 3, color = "black") +
  # Annotations for key events (example)
  annotate("text", x = as.Date("2020-07-01"), y = 4.5, label = "COVID-19 Lockdown", color = "darkblue", angle = 0, vjust = 1) +
  annotate("text", x = as.Date("2021-10-01"), y = 6.5, label = "Economic Recovery", color = "darkgreen", angle = 0, vjust = 1) +
  # Custom x-axis breaks for quarters
  scale_x_date(date_breaks = "3 months", date_labels = "%b'%y") +
  scale_color_manual(values = line_colors, name = "Year") +
  # Labels and themes
  labs(
    title = "Overall Inflation Trend (2020-2023)",
    x = "Date",
    y = "Year-on-Year Percentage Change in CPI"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x.bottom = element_text(angle = 45, hjust = 1),
    axis.text.x.top = element_text(vjust = 2.5, hjust = 0.5),
    legend.position = "none",
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    panel.border = element_blank(),
    plot.margin = margin(t = 20, r = 20, b = 20, l = 20)
  )
```
# Overview Visualization - 2
```{r}
#| label: overview-visualization-2

#  to make the y scale format consistent (1 decimal place)
one_dp_format <- function(x) sprintf("%.1f", x)

ggplot(combined_all_items_data, aes(x = Month)) +
  geom_line(aes(y = Value_Average, color = "Average (2020-2022)")) +
  geom_line(aes(y = Value_2023, color = "2023")) +
  labs(
    title = "Singapore's average inflation trend for all items", 
    x = "Month", 
    y = "Rate (%)",
    color = "Inflation Rate"  # Change legend title here
    ) +
  scale_color_manual(values = c("Average (2020-2022)" = "blue", "2023" = "red")) +
  theme_minimal() +
  scale_x_continuous(breaks = c(1, 6, 12), labels = c("Jan", "Jun", "Dec")) + 
  scale_y_continuous(labels = one_dp_format) +
  theme(
    plot.title = element_text(face="bold"),
    axis.title.x = element_text(face = "bold", vjust="1.2"),
    axis.title.y = element_text(face = "bold"),
    legend.title = element_text(face = "bold"),
  )
  
combined_all_items_data
```

# Overview Visualization - 3
```{r}
#| label: overview-visualization-3

# Define custom colors for the lines
line_colors <- c("2020" = "grey", "2021" = "grey", "2022" = "grey", "2023" = "blue")

# Generate the line plot with enhanced background blocks and additional improvements
ggplot(all_items_data, aes(x = Date, y = Value, group = 1)) +
  # Background blocks
  geom_rect(data = all_items_data, aes(xmin = Date, xmax = lead(Date, default = last(Date)), 
                                       ymin = -Inf, ymax = Inf), alpha = 0.1, fill = "lightgrey") +
  # Main line and points
  geom_line(aes(color = as.factor(Year)), size = 1.5) +
  # geom_point(size = 3, color = "black") +
  # Annotations for key events (example)
  annotate("text", x = as.Date("2020-07-01"), y = 4.5, label = "COVID-19 Lockdown", color = "darkblue", angle = 0, vjust = 1) +
  annotate("text", x = as.Date("2021-10-01"), y = 6.5, label = "Economic Recovery", color = "darkgreen", angle = 0, vjust = 1) +
  # Custom x-axis breaks for quarters
  scale_x_date(date_breaks = "3 months", date_labels = "%b'%y") +
  scale_color_manual(values = line_colors, name = "Year") +
  # Add average line
  geom_line(data = combined_all_items_data, aes(x = Date, y = Value_Average), linetype = "dashed", color = "red", size = 1) +
  # Labels and themes
  labs(
    title = "Overall Inflation Trend (2020-2023)",
    x = "Date",
    y = "Year-on-Year Percentage Change in CPI"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x.bottom = element_text(angle = 45, hjust = 1),
    axis.text.x.top = element_text(vjust = 2.5, hjust = 0.5),
    legend.position = "none",
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    panel.border = element_blank(),
    plot.margin = margin(t = 20, r = 20, b = 20, l = 20)
  )
```

# Improved Visualization
```{r}
#| label: improved-visualization
#| fig.width: 8.5
#| fig.height: 5

#  to make the y scale format consistent (1 decimal place)
one_dp_format <- function(x) sprintf("%.1f", x)

line_plot <- ggplot(combined_data, aes(x = Month)) +
  geom_line(aes(y = Value_Average, color = "Average (2020-2022)")) +
  geom_line(aes(y = Value_2023, color = "2023")) +
  facet_wrap(~ Variables, scales = "free_y", axes="all", axis.labels="all_x") +
  labs(
    title = "Singapore's Past Average Inflation Trends (2020-2022) vs 2023", 
    x = "Month", 
    y = "Rate (%)",
    color = "Inflation Rate"  # Change legend title here,h
  ) +
  scale_color_manual(values = c("Average (2020-2022)" = "blue", "2023" = "red")) +
  theme_minimal() +
  scale_x_continuous(breaks = c(1, 6, 12), labels = c("Jan", "Jun", "Dec")) +
  scale_y_continuous(labels = one_dp_format) +
  theme(
    plot.title = element_text(face="bold"),
    axis.title.x = element_text(face = "bold", vjust="1.2"),
    axis.title.y = element_text(face = "bold"),
    legend.title = element_text(face = "bold"),
  )

line_plot
```

# Further Suggestions for Interactivity

As our visualisation was to be non-interactive for a poster, we did not implement any interactive features. However, if the visualization were to be interactive, a few features would be considered. They are as follows:

1.  *Interactive plots* for the users to potentially select the number of years they would like to view for the inflation rate over the past few years. This can be achieved with the *plotly* library in R which helps to embed interactivity into web applications.
2.  *A dashboard* for users to interact with various elements of our chart to display the data that they want to see. This can be accomplished with the *shiny* library in R which helps to build complex dashboards and applications that display interactive plots, tables and other UI elements.
3.  Another library to help with interactivity would be *highcharter* which makes use of the Highcharts JavaScript library to provide a simple interface to generate sophisticated and highly customizable charts.

# Conclusion

We successfully implemented all suggested improvements for the non-interactive visualization. By labeling every state and choosing a colorblind-friendly palette, the revised plot is more accessible. The logarithmic color scale makes the decrease in incidence after the introduction of the vaccine less striking but enables readers to detect patterns in the low-incidence range more easily.
